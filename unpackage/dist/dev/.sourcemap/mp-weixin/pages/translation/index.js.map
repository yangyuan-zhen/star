{"version":3,"file":"index.js","sources":["pages/translation/index.vue","../../../../360极速浏览器下载/HBuilderX.4.29.2024093009/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdHJhbnNsYXRpb24vaW5kZXgudnVl"],"sourcesContent":["<template>\r\n  <view class=\"translation\">\r\n    <view class=\"input-section\">\r\n      <textarea\r\n        v-model=\"inputText\"\r\n        class=\"input-area\"\r\n        placeholder=\"请输入要翻译的任意文字任何一种语言的内容，准确地翻译成中文表达。\"\r\n        :maxlength=\"-1\"\r\n      />\r\n      <view class=\"btn-group\">\r\n        <button class=\"base-btn clear-btn\" @tap=\"clearInput\">清空</button>\r\n        <button\r\n          class=\"base-btn translate-btn\"\r\n          @tap=\"handleTranslate\"\r\n          :disabled=\"isLoading\"\r\n        >\r\n          {{ isLoading ? \"翻译中...\" : \"翻译\" }}\r\n        </button>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 功能说明区域，当没有翻译结果时显示 -->\r\n    <view class=\"feature-section\" v-if=\"!translatedText\">\r\n      <view class=\"feature-title\">功能说明</view>\r\n      <view class=\"feature-list\">\r\n        <view class=\"feature-item\">\r\n          <view class=\"item-header\">\r\n            <text class=\"item-number\">01</text>\r\n            <text class=\"item-title\">输入功能</text>\r\n          </view>\r\n          <view class=\"item-desc\">支持输入任意语言的文字，一键清空内容</view>\r\n        </view>\r\n        <view class=\"feature-item\">\r\n          <view class=\"item-header\">\r\n            <text class=\"item-number\">02</text>\r\n            <text class=\"item-title\">翻译功能</text>\r\n          </view>\r\n          <view class=\"item-desc\">准确翻译成中文表达，翻译过程有加载提示</view>\r\n        </view>\r\n        <view class=\"feature-item\">\r\n          <view class=\"item-header\">\r\n            <text class=\"item-number\">03</text>\r\n            <text class=\"item-title\">结果展示</text>\r\n          </view>\r\n          <view class=\"item-desc\"\r\n            >显示翻译结果，并提供重点词汇分析，包含词义解释和难度级别</view\r\n          >\r\n        </view>\r\n      </view>\r\n    </view>\r\n\r\n    <!-- 翻译结果区域 -->\r\n    <view class=\"result-section\" v-else>\r\n      <view class=\"result-header\">\r\n        <view class=\"result-title\"> 翻译结果 </view>\r\n      </view>\r\n      <view class=\"result-content\">{{ processedTranslation.translation }}</view>\r\n\r\n      <view\r\n        class=\"vocabulary-section\"\r\n        v-if=\"processedTranslation.vocabulary?.length\"\r\n      >\r\n        <view class=\"category-title\">重点词汇分析</view>\r\n        <view class=\"word-list\">\r\n          <view\r\n            class=\"word-item\"\r\n            v-for=\"(item, index) in processedTranslation.vocabulary\"\r\n            :key=\"index\"\r\n          >\r\n            <view class=\"word-header\">{{ item.word }}</view>\r\n            <view class=\"word-explanation\">{{ item.explanation }}</view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from \"vue\";\r\nimport { translateText } from \"../../api/search.js\";\r\n\r\nconst inputText = ref(\"\");\r\nconst translatedText = ref(\"\");\r\nconst isLoading = ref(false);\r\n\r\nconst shareInfo = {\r\n  title: \"AI智能翻译助手\",\r\n  path: \"/pages/translation/index\",\r\n  imageUrl: \"\", // 可以添加分享图片的路径\r\n  desc: \"支持多语言智能翻译\",\r\n};\r\n\r\n// 分享给朋友\r\nconst onShareAppMessage = () => {\r\n  return {\r\n    title: shareInfo.title,\r\n    path: shareInfo.path,\r\n    imageUrl: shareInfo.imageUrl,\r\n    desc: shareInfo.desc,\r\n  };\r\n};\r\n\r\n// 分享到朋友圈\r\nconst onShareTimeline = () => {\r\n  return {\r\n    title: shareInfo.title,\r\n    path: shareInfo.path,\r\n    imageUrl: shareInfo.imageUrl,\r\n    query: \"\", // 可选：分享时携带的查询参数\r\n  };\r\n};\r\n\r\n// 将这两个方法定义为页面选项\r\ndefineExpose({\r\n  onShareAppMessage,\r\n  onShareTimeline,\r\n});\r\n\r\nconst handleTranslate = async () => {\r\n  // 检查是否已有翻译结果\r\n  if (translatedText.value) {\r\n    uni.showToast({\r\n      title: \"请清空输入框再翻译\",\r\n      icon: \"none\",\r\n    });\r\n    return;\r\n  }\r\n\r\n  isLoading.value = true;\r\n  try {\r\n    const result = await translateText(inputText.value);\r\n    translatedText.value = result.output;\r\n    console.log(result);\r\n  } catch (error) {\r\n    uni.showToast({\r\n      title: error.message || \"翻译失败，请稍后重试\",\r\n      icon: \"none\",\r\n    });\r\n  } finally {\r\n    isLoading.value = false;\r\n  }\r\n};\r\n\r\nconst clearInput = () => {\r\n  inputText.value = \"\";\r\n  translatedText.value = \"\";\r\n};\r\n\r\n// 添加数据处理计算属性\r\nconst processedTranslation = computed(() => {\r\n  if (!translatedText.value) return { translation: \"\", vocabulary: [] };\r\n\r\n  const lines = translatedText.value.split(\"\\n\").filter((line) => line.trim());\r\n\r\n  // 获取翻译文本（第一段）\r\n  const translation = lines[0]?.trim() || \"\";\r\n\r\n  // 获取词汇解释\r\n  const vocabularyStartIndex = lines.findIndex((line) =>\r\n    line.includes(\"重点词汇分析\")\r\n  );\r\n\r\n  // 如果没有找到\"重点词汇分析\"，返回空数组\r\n  if (vocabularyStartIndex === -1) {\r\n    return { translation, vocabulary: [] };\r\n  }\r\n\r\n  const vocabularyLines = lines.slice(vocabularyStartIndex + 1);\r\n\r\n  const vocabulary = vocabularyLines\r\n    .filter((line) => line.trim().startsWith(\"-\"))\r\n    .map((line) => {\r\n      const content = line.replace(\"-\", \"\").trim();\r\n      // 分割词语和解释\r\n      const mainParts = content.split(\"：\");\r\n      if (mainParts.length < 2) {\r\n        return { word: content, explanation: \"\" };\r\n      }\r\n      const word = mainParts[0].trim();\r\n      const explanation = mainParts[1].trim();\r\n      return { word, explanation };\r\n    });\r\n\r\n  return { translation, vocabulary };\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.translation {\r\n  padding: $uni-spacing-base;\r\n  max-width: 900rpx;\r\n  margin: 0 auto;\r\n\r\n  .input-section {\r\n    .input-area {\r\n      width: 100%;\r\n      min-height: 240rpx;\r\n      padding: $uni-spacing-base;\r\n      border: 2rpx solid $uni-color-border;\r\n      border-radius: $uni-radius-sm;\r\n      box-sizing: border-box;\r\n      font-size: $uni-font-size-base;\r\n      transition: all 0.3s ease;\r\n\r\n      &:focus {\r\n        border-color: $uni-color-primary;\r\n        box-shadow: 0 0 0 2rpx rgba($uni-color-primary, 0.1);\r\n      }\r\n    }\r\n\r\n    .btn-group {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      margin-top: $uni-spacing-base;\r\n      gap: $uni-spacing-base;\r\n    }\r\n  }\r\n\r\n  .base-btn {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: $uni-spacing-xs;\r\n    padding: $uni-spacing-sm $uni-spacing-lg;\r\n    border-radius: $uni-border-radius;\r\n    font-size: $uni-font-size-base;\r\n    font-weight: 500;\r\n    transition: all 0.2s ease;\r\n\r\n    &:active {\r\n      transform: scale(0.98);\r\n    }\r\n  }\r\n\r\n  .clear-btn {\r\n    flex: 1;\r\n    background-color: $uni-bg-color-grey;\r\n    color: $uni-text-color-grey;\r\n  }\r\n\r\n  .translate-btn {\r\n    flex: 1;\r\n    background-color: $uni-color-primary;\r\n    color: $uni-color-white;\r\n    &:disabled {\r\n      opacity: 0.7;\r\n      cursor: not-allowed;\r\n    }\r\n  }\r\n\r\n  .result-section {\r\n    margin-top: $uni-spacing-xl;\r\n    background-color: $uni-bg-color;\r\n    border-radius: $uni-radius-sm;\r\n    border: 2rpx solid $uni-color-border;\r\n    overflow: hidden;\r\n\r\n    .result-header {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      padding: $uni-spacing-base;\r\n      border-bottom: 2rpx solid $uni-color-border;\r\n      background-color: $uni-bg-color-grey;\r\n\r\n      .result-title {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: $uni-spacing-xs;\r\n        font-size: $uni-font-size-base;\r\n        color: $uni-text-color;\r\n        font-weight: 500;\r\n      }\r\n    }\r\n\r\n    .result-content {\r\n      padding: $uni-spacing-lg;\r\n      font-size: $uni-font-size-lg;\r\n      line-height: 1.8;\r\n      color: $uni-text-color;\r\n      border-bottom: 2rpx solid $uni-color-border;\r\n    }\r\n  }\r\n\r\n  .loading {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: $uni-spacing-xs;\r\n    padding: $uni-spacing-base;\r\n    color: $uni-text-color-grey;\r\n  }\r\n}\r\n\r\n.vocabulary-section {\r\n  padding: $uni-spacing-base;\r\n\r\n  .category-title {\r\n    font-size: $uni-font-size-base;\r\n    font-weight: 500;\r\n    color: $uni-text-color;\r\n    margin-bottom: $uni-spacing-sm;\r\n  }\r\n\r\n  .word-list {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: $uni-spacing-sm;\r\n\r\n    .word-item {\r\n      padding: $uni-spacing-sm;\r\n      background-color: $uni-bg-color-grey;\r\n      border-radius: $uni-border-radius;\r\n\r\n      .word-header {\r\n        color: $uni-text-color;\r\n        font-weight: 500;\r\n        font-size: $uni-font-size-base;\r\n        margin-bottom: $uni-spacing-xs;\r\n      }\r\n\r\n      .word-explanation {\r\n        color: $uni-text-color-grey;\r\n        font-size: $uni-font-size-sm;\r\n        line-height: 1.6;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.feature-section {\r\n  margin-top: $uni-spacing-xl;\r\n  background-color: $uni-bg-color;\r\n  border-radius: $uni-radius-lg;\r\n  padding: $uni-spacing-xl;\r\n  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.05);\r\n\r\n  .feature-title {\r\n    font-size: $uni-font-size-xl;\r\n    font-weight: 600;\r\n    color: $uni-text-color;\r\n    margin-bottom: $uni-spacing-xl;\r\n    position: relative;\r\n    padding-left: $uni-spacing-lg;\r\n\r\n    &::before {\r\n      content: \"\";\r\n      position: absolute;\r\n      left: 0;\r\n      top: 50%;\r\n      transform: translateY(-50%);\r\n      width: 6rpx;\r\n      height: 32rpx;\r\n      background-color: $uni-color-primary;\r\n      border-radius: $uni-border-radius;\r\n    }\r\n  }\r\n\r\n  .feature-list {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: $uni-spacing-xl;\r\n\r\n    .feature-item {\r\n      background-color: $uni-bg-color-grey;\r\n      padding: $uni-spacing-lg;\r\n      border-radius: $uni-radius-base;\r\n      transition: all 0.3s ease;\r\n\r\n      &:hover {\r\n        transform: translateX(8rpx);\r\n      }\r\n\r\n      .item-header {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: $uni-spacing-base;\r\n        margin-bottom: $uni-spacing-sm;\r\n\r\n        .item-number {\r\n          font-size: $uni-font-size-sm;\r\n          font-weight: 600;\r\n          color: $uni-color-primary;\r\n          background-color: rgba($uni-color-primary, 0.1);\r\n          padding: 4rpx 12rpx;\r\n          border-radius: $uni-radius-sm;\r\n        }\r\n\r\n        .item-title {\r\n          font-size: $uni-font-size-lg;\r\n          font-weight: 500;\r\n          color: $uni-text-color;\r\n        }\r\n      }\r\n\r\n      .item-desc {\r\n        color: $uni-text-color-grey;\r\n        font-size: $uni-font-size-base;\r\n        line-height: 1.6;\r\n        padding-left: calc($uni-spacing-base + 40rpx); // 与序号对齐\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import MiniProgramPage from 'D:/por/cursor/xcx/freeyunpan/pages/translation/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","translateText","computed","MiniProgramPage"],"mappings":";;;;;;AAkFA,UAAA,YAAAA,cAAAA,IAAA,EAAA;AACA,UAAA,iBAAAA,cAAAA,IAAA,EAAA;AACA,UAAA,YAAAA,cAAAA,IAAA,KAAA;AAEA,UAAA,YAAA;AAAA,MACA,OAAA;AAAA,MACA,MAAA;AAAA,MACA,UAAA;AAAA;AAAA,MACA,MAAA;AAAA,IACA;AAGA,UAAA,oBAAA,MAAA;AACA,aAAA;AAAA,QACA,OAAA,UAAA;AAAA,QACA,MAAA,UAAA;AAAA,QACA,UAAA,UAAA;AAAA,QACA,MAAA,UAAA;AAAA,MACA;AAAA,IACA;AAGA,UAAA,kBAAA,MAAA;AACA,aAAA;AAAA,QACA,OAAA,UAAA;AAAA,QACA,MAAA,UAAA;AAAA,QACA,UAAA,UAAA;AAAA,QACA,OAAA;AAAA;AAAA,MACA;AAAA,IACA;AAGA,aAAA;AAAA,MACA;AAAA,MACA;AAAA,IACA,CAAA;AAEA,UAAA,kBAAA,YAAA;AAEA,UAAA,eAAA,OAAA;AACAC,sBAAAA,MAAA,UAAA;AAAA,UACA,OAAA;AAAA,UACA,MAAA;AAAA,QACA,CAAA;AACA;AAAA,MACA;AAEA,gBAAA,QAAA;AACA,UAAA;AACA,cAAA,SAAA,MAAAC,WAAAA,cAAA,UAAA,KAAA;AACA,uBAAA,QAAA,OAAA;AACAD,sBAAAA,MAAA,MAAA,OAAA,sCAAA,MAAA;AAAA,MACA,SAAA,OAAA;AACAA,sBAAAA,MAAA,UAAA;AAAA,UACA,OAAA,MAAA,WAAA;AAAA,UACA,MAAA;AAAA,QACA,CAAA;AAAA,MACA,UAAA;AACA,kBAAA,QAAA;AAAA,MACA;AAAA,IACA;AAEA,UAAA,aAAA,MAAA;AACA,gBAAA,QAAA;AACA,qBAAA,QAAA;AAAA,IACA;AAGA,UAAA,uBAAAE,cAAA,SAAA,MAAA;;AACA,UAAA,CAAA,eAAA;AAAA,eAAA,EAAA,aAAA,IAAA,YAAA,CAAA;AAEA,YAAA,QAAA,eAAA,MAAA,MAAA,IAAA,EAAA,OAAA,CAAA,SAAA,KAAA,KAAA,CAAA;AAGA,YAAA,gBAAA,WAAA,CAAA,MAAA,mBAAA,WAAA;AAGA,YAAA,uBAAA,MAAA;AAAA,QAAA,CAAA,SACA,KAAA,SAAA,QAAA;AAAA,MACA;AAGA,UAAA,yBAAA,IAAA;AACA,eAAA,EAAA,aAAA,YAAA,CAAA;MACA;AAEA,YAAA,kBAAA,MAAA,MAAA,uBAAA,CAAA;AAEA,YAAA,aAAA,gBACA,OAAA,CAAA,SAAA,KAAA,KAAA,EAAA,WAAA,GAAA,CAAA,EACA,IAAA,CAAA,SAAA;AACA,cAAA,UAAA,KAAA,QAAA,KAAA,EAAA,EAAA;AAEA,cAAA,YAAA,QAAA,MAAA,GAAA;AACA,YAAA,UAAA,SAAA,GAAA;AACA,iBAAA,EAAA,MAAA,SAAA,aAAA,GAAA;AAAA,QACA;AACA,cAAA,OAAA,UAAA,CAAA,EAAA,KAAA;AACA,cAAA,cAAA,UAAA,CAAA,EAAA,KAAA;AACA,eAAA,EAAA,MAAA;MACA,CAAA;AAEA,aAAA,EAAA,aAAA;IACA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxLA,GAAG,WAAWC,SAAe;"}